[package]
name = "openlark-client"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
description = "现代化飞书开放平台 Rust SDK - 简化客户端，支持功能驱动的模块化编译"

[dependencies]
# Core dependencies
openlark-core = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
async-trait = { workspace = true }
tokio = { workspace = true }
tracing = { workspace = true }
thiserror = { workspace = true }

# Additional dependencies for unified client
chrono = { workspace = true, features = ["serde"] }
uuid = { workspace = true, features = ["v4"] }

# WebSocket dependencies
tokio-tungstenite = { workspace = true, optional = true }
futures-util = { workspace = true, optional = true }
lark-websocket-protobuf = { workspace = true, optional = true }
url = { workspace = true, optional = true }
prost = { workspace = true, optional = true }
reqwest = { workspace = true, optional = true }
log = { workspace = true, optional = true }

# P0 Phase 1 业务模块依赖
openlark-communication = { workspace = true, optional = true }
openlark-docs = { workspace = true, optional = true }
openlark-security = { workspace = true, optional = true }

# Phase 2+ 模块依赖（暂时注释）
# openlark-hr = { workspace = true, optional = true }
# openlark-admin = { workspace = true, optional = true }
# openlark-approval = { workspace = true, optional = true }
# openlark-helpdesk = { workspace = true, optional = true }
# openlark-application = { workspace = true, optional = true }
# openlark-mail = { workspace = true, optional = true }
# openlark-apass = { workspace = true, optional = true }
# openlark-hire = { workspace = true, optional = true }
# openlark-lingo = { workspace = true, optional = true }
# openlark-task = { workspace = true, optional = true }

[features]
default = ["communication"]

# Core client feature
client = []

# WebSocket support
websocket = ["tokio-tungstenite", "futures-util", "lark-websocket-protobuf", "url", "prost", "reqwest", "log"]

# P0 Phase 1 business service features
communication = ["openlark-communication"]    # 通讯和消息
docs = ["openlark-docs"]                    # 文档和知识库
security = ["openlark-security"]              # 安全认证

# P0 3-layer architecture features
core-layer = [
    "communication",  # IM、消息、联系人管理
    "docs",           # 云文档、表格、知识库
    "security",       # 安全认证
]

# Convenience features - P0模块组合
p0-services = [
    "communication", "docs", "security"
]

# Complete client features for easy selection
client-communication = ["client", "communication"]
client-docs = ["client", "docs"]
client-security = ["client", "security"]
client-p0 = ["client", "p0-services"]

[dev-dependencies]
tokio-test = "0.4"
wiremock = { workspace = true }
rstest = { workspace = true }
tempfile = { workspace = true }
mockall = { workspace = true }

[[example]]
name = "service_registry_demo"
path = "../../examples/service_registry_demo.rs"
required-features = ["communication"]

[[example]]
name = "docs_service_demo"
path = "../../examples/docs_service_demo.rs"
required-features = ["docs"]

[[example]]
name = "security_service_demo"
path = "../../examples/security_service_demo.rs"
required-features = ["security"]