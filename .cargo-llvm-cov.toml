# cargo-llvm-cov configuration
# See: https://github.com/taiki-e/cargo-llvm-cov

[coverage]
# Minimum coverage threshold (percentage)
# Set to 65% initially, can be increased gradually
min-total = 65.0
min-per-crate = 60.0

[report]
# Report formats to generate
formats = ["html", "lcov", "text"]

# Output directory for HTML reports
html-dir = "target/llvm-cov/html"

# LCOV output file (for CI integration)
lcov-file = "target/llvm-cov/lcov.info"

[ignore]
# Ignore test files from coverage
patterns = [
    "tests/*",
    "benches/*", 
    "examples/*",
    "tools/*",
    "src/bin/*",
    # Ignore generated protobuf code
    "crates/protobuf/src/*.rs",
]

[workspace]
# Include all workspace members
include-all-members = true

# Exclude specific crates if needed
exclude = []

[test]
# 使用 --all-features 代替 features 数组，确保所有功能都被测试
all-features = true  # Run coverage with all features enabled