use std::sync::Arc;

use crate::core::config::Config;

/// æ•°æ®æ“ä½œåŠŸèƒ½
pub mod data_operation;
/// è¡Œåˆ—æ“ä½œåŠŸèƒ½
pub mod sheet_row_col;
/// å·¥ä½œè¡¨åŠŸèƒ½
pub mod spreadsheet_sheet;

/// Sheets API v2ç‰ˆæœ¬æœåŠ¡é›†åˆ
///
/// æä¾›ç”µå­è¡¨æ ¼çš„åŸºç¡€åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®è¯»å†™ã€å·¥ä½œè¡¨ç®¡ç†ç­‰æ ¸å¿ƒæ“ä½œã€‚
/// v2ç‰ˆæœ¬æ˜¯ç¨³å®šçš„åŸºç¡€APIç‰ˆæœ¬ï¼Œé€‚ç”¨äºå¤§å¤šæ•°å¸¸è§çš„ç”µå­è¡¨æ ¼æ“ä½œéœ€æ±‚ã€‚
///
/// # ä¸»è¦åŠŸèƒ½æ¨¡å—
///
/// - **spreadsheet**: ç”µå­è¡¨æ ¼çš„åŸºç¡€ç®¡ç†åŠŸèƒ½
/// - **spreadsheet_sheet**: å·¥ä½œè¡¨çš„åˆ›å»ºã€åˆ é™¤å’ŒåŸºç¡€æ“ä½œ
/// - **data_operation**: æ•°æ®çš„è¯»å†™å’ŒåŸºæœ¬æ“ä½œï¼ˆé€šè¿‡å­æ¨¡å—å®ç°ï¼‰
/// - **sheet_row_col**: è¡Œåˆ—çš„åŸºç¡€ç»“æ„æ“ä½œï¼ˆé€šè¿‡å­æ¨¡å—å®ç°ï¼‰
///
/// # APIç‰ˆæœ¬å¯¹æ¯”
///
/// v2ç‰ˆæœ¬ç›¸æ¯”v3ç‰ˆæœ¬åŠŸèƒ½è¾ƒä¸ºåŸºç¡€ï¼Œä½†å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š
/// - ğŸ”§ APIç¨³å®šï¼Œå‘åå…¼å®¹æ€§å¥½
/// - âš¡ å“åº”é€Ÿåº¦å¿«ï¼Œèµ„æºå ç”¨å°‘
/// - ğŸ¯ åŠŸèƒ½ä¸“æ³¨ï¼Œé€‚åˆç®€å•åœºæ™¯
/// - ğŸ“– æ–‡æ¡£å®Œå–„ï¼Œç¤ºä¾‹ä¸°å¯Œ
///
/// # ä½¿ç”¨ç¤ºä¾‹
///
/// ```rust
/// use open_lark::prelude::*;
///
/// let client = LarkClient::builder("app_id", "app_secret")
///     .with_app_type(AppType::SelfBuild)
///     .build();
///
/// // ä½¿ç”¨v2ç‰ˆæœ¬API
/// let sheets_v2 = &client.sheets.v2;
///
/// // åŸºç¡€å·¥ä½œè¡¨æ“ä½œ
/// // let sheet_ops = &sheets_v2.spreadsheet_sheet;
/// ```
///
/// # é€‚ç”¨åœºæ™¯
///
/// - ç®€å•çš„æ•°æ®è¯»å†™æ“ä½œ
/// - åŸºç¡€çš„å·¥ä½œè¡¨ç®¡ç†
/// - å¯¹APIç¨³å®šæ€§è¦æ±‚é«˜çš„åœºæ™¯
/// - è½»é‡çº§é›†æˆéœ€æ±‚
pub struct V2 {
    /// ç”µå­è¡¨æ ¼æœåŠ¡ - æä¾›è¡¨æ ¼çº§åˆ«çš„åŸºç¡€æ“ä½œ
    pub spreadsheet: SpreadsheetService,
    /// å·¥ä½œè¡¨æœåŠ¡ - ç®¡ç†å·¥ä½œè¡¨çš„åŸºç¡€åŠŸèƒ½
    pub spreadsheet_sheet: SpreadsheetSheetService,
}

impl V2 {
    /// åˆ›å»ºæ–°çš„V2ç‰ˆæœ¬æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®ï¼ŒåŒ…å«è®¤è¯ä¿¡æ¯å’ŒAPIè®¾ç½®
    ///
    /// # è¿”å›å€¼
    /// é…ç½®å®Œæˆçš„V2æœåŠ¡å®ä¾‹ï¼ŒåŒ…å«åŸºç¡€çš„æœåŠ¡æ¨¡å—
    pub fn new(config: Arc<Config>) -> Self {
        Self {
            spreadsheet: SpreadsheetService::new(Arc::clone(&config)),
            spreadsheet_sheet: SpreadsheetSheetService::new(config),
        }
    }
}

/// ç”µå­è¡¨æ ¼æœåŠ¡ï¼ˆV2ç‰ˆæœ¬ï¼‰
///
/// æä¾›ç”µå­è¡¨æ ¼çš„åŸºç¡€ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬è¡¨æ ¼çš„åˆ›å»ºã€è·å–å’ŒåŸºæœ¬å±æ€§è®¾ç½®ã€‚
/// V2ç‰ˆæœ¬ä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½ï¼Œæä¾›ç¨³å®šå¯é çš„APIæ¥å£ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// - ğŸ“Š åˆ›å»ºæ–°çš„ç”µå­è¡¨æ ¼
/// - ğŸ“‹ è·å–è¡¨æ ¼åŸºæœ¬ä¿¡æ¯
/// - âœï¸ æ›´æ–°è¡¨æ ¼åŸºç¡€å±æ€§
/// - ğŸ” æŸ¥è¯¢è¡¨æ ¼çŠ¶æ€
///
/// # åŠŸèƒ½ç‰¹ç‚¹
///
/// - âœ… APIç¨³å®šï¼Œå…¼å®¹æ€§å¼º
/// - ğŸš€ å“åº”å¿«é€Ÿï¼Œæ€§èƒ½å¯é 
/// - ğŸ¯ åŠŸèƒ½æ˜ç¡®ï¼Œæ˜“äºä½¿ç”¨
/// - ğŸ“š æ–‡æ¡£å®Œå–„ï¼Œç¤ºä¾‹ä¸°å¯Œ
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - åŸºç¡€è¡¨æ ¼ç®¡ç†ç³»ç»Ÿ
/// - ç®€å•æ•°æ®å¯¼å…¥å¯¼å‡º
/// - è½»é‡çº§æŠ¥è¡¨ç”Ÿæˆ
/// - å¿«é€ŸåŸå‹å¼€å‘
///
/// # ä¸V3ç‰ˆæœ¬å¯¹æ¯”
///
/// V2ç‰ˆæœ¬æ›´åŠ ç®€æ´ï¼Œé€‚åˆåŸºç¡€éœ€æ±‚ï¼›V3ç‰ˆæœ¬åŠŸèƒ½æ›´å¼ºå¤§ï¼Œé€‚åˆå¤æ‚åœºæ™¯ã€‚
/// å»ºè®®æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©åˆé€‚çš„ç‰ˆæœ¬ã€‚
pub struct SpreadsheetService {
    config: Config,
}

impl SpreadsheetService {
    /// åˆ›å»ºæ–°çš„ç”µå­è¡¨æ ¼æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}

/// å·¥ä½œè¡¨æœåŠ¡ï¼ˆV2ç‰ˆæœ¬ï¼‰
///
/// ç®¡ç†ç”µå­è¡¨æ ¼å†…å·¥ä½œè¡¨çš„åŸºç¡€åŠŸèƒ½ï¼Œæ”¯æŒå·¥ä½œè¡¨çš„åˆ›å»ºã€åˆ é™¤ã€
/// é‡å‘½åç­‰å¸¸ç”¨æ“ä½œã€‚æä¾›ç¨³å®šå¯é çš„å·¥ä½œè¡¨ç®¡ç†æ¥å£ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// - ğŸ“„ åˆ›å»ºæ–°å·¥ä½œè¡¨
/// - ğŸ“ é‡å‘½åå·¥ä½œè¡¨
/// - ğŸ—‘ï¸ åˆ é™¤å·¥ä½œè¡¨
/// - ğŸ“‹ è·å–å·¥ä½œè¡¨ä¿¡æ¯
/// - ğŸ¨ è®¾ç½®åŸºç¡€å±æ€§
///
/// # åŠŸèƒ½ç‰¹è‰²
///
/// - ğŸ”§ æ“ä½œç®€å•ç›´è§‚
/// - âš¡ æ‰§è¡Œæ•ˆç‡é«˜
/// - ğŸ›¡ï¸ é”™è¯¯å¤„ç†å®Œå–„
/// - ğŸ“– ä½¿ç”¨æ–¹å¼æ¸…æ™°
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - å¤šå·¥ä½œè¡¨æ•°æ®ç®¡ç†
/// - åŸºç¡€è¡¨æ ¼ç»“æ„æ­å»º
/// - ç®€å•çš„å·¥ä½œè¡¨æ¨¡æ¿
/// - æ•°æ®åˆ†ç±»æ•´ç†
///
/// # æœ€ä½³å®è·µ
///
/// - åˆç†è§„åˆ’å·¥ä½œè¡¨ç»“æ„
/// - ä½¿ç”¨æœ‰æ„ä¹‰çš„å·¥ä½œè¡¨åç§°
/// - é¿å…é¢‘ç¹çš„å·¥ä½œè¡¨æ“ä½œ
/// - åŠæ—¶æ¸…ç†ä¸éœ€è¦çš„å·¥ä½œè¡¨
pub struct SpreadsheetSheetService {
    config: Config,
}

impl SpreadsheetSheetService {
    /// åˆ›å»ºæ–°çš„å·¥ä½œè¡¨æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}
