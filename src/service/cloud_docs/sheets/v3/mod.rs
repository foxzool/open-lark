use std::sync::Arc;

use crate::core::config::Config;

/// æ¡ä»¶æ ¼å¼åŒ–åŠŸèƒ½
pub mod condition_format;
/// æ•°æ®æ“ä½œåŠŸèƒ½
pub mod data_operation;
/// æ•°æ®éªŒè¯åŠŸèƒ½
pub mod data_validation;
/// æµ®åŠ¨å›¾ç‰‡åŠŸèƒ½
pub mod float_image;
/// ä¿æŠ¤åŒºåŸŸåŠŸèƒ½
pub mod protect_range;
/// è¡Œåˆ—æ“ä½œåŠŸèƒ½
pub mod sheet_row_col;
/// ç”µå­è¡¨æ ¼åŠŸèƒ½
pub mod spreadsheet;
/// å·¥ä½œè¡¨åŠŸèƒ½
pub mod spreadsheet_sheet;
/// å·¥ä½œè¡¨ç­›é€‰åŠŸèƒ½
pub mod spreadsheet_sheet_filter;
/// å·¥ä½œè¡¨ç­›é€‰è§†å›¾åŠŸèƒ½
pub mod spreadsheet_sheet_filter_view;
/// å·¥ä½œè¡¨ç­›é€‰è§†å›¾æ¡ä»¶åŠŸèƒ½
pub mod spreadsheet_sheet_filter_view_condition;

/// Sheets API v3ç‰ˆæœ¬æœåŠ¡é›†åˆ
///
/// æä¾›ç”µå­è¡¨æ ¼çš„å®Œæ•´åŠŸèƒ½é›†ï¼ŒåŒ…æ‹¬æ•°æ®æ“ä½œã€æ ¼å¼è®¾ç½®ã€ç­›é€‰ã€ä¿æŠ¤ç­‰é«˜çº§ç‰¹æ€§ã€‚
/// v3ç‰ˆæœ¬ç›¸æ¯”v2ç‰ˆæœ¬æä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½å’Œæ›´å¥½çš„æ€§èƒ½ã€‚
///
/// # ä¸»è¦åŠŸèƒ½æ¨¡å—
///
/// - **spreadsheet**: ç”µå­è¡¨æ ¼çš„åˆ›å»ºã€åˆ é™¤ã€è·å–ç­‰åŸºç¡€æ“ä½œ
/// - **spreadsheet_sheet**: å·¥ä½œè¡¨çš„ç®¡ç†å’Œæ“ä½œ
/// - **data_operation**: æ•°æ®çš„è¯»å†™ã€æŸ¥æ‰¾ã€æ›¿æ¢ç­‰æ“ä½œ
/// - **sheet_row_col**: è¡Œåˆ—çš„æ’å…¥ã€åˆ é™¤ã€è°ƒæ•´ç­‰æ“ä½œ
/// - **spreadsheet_sheet_filter**: å·¥ä½œè¡¨ç­›é€‰åŠŸèƒ½
/// - **spreadsheet_sheet_filter_view**: ç­›é€‰è§†å›¾ç®¡ç†
///
/// # ä½¿ç”¨ç¤ºä¾‹
///
/// ```rust
/// use open_lark::prelude::*;
///
/// let client = LarkClient::builder("app_id", "app_secret")
///     .with_app_type(AppType::SelfBuild)
///     .build();
///
/// // ä½¿ç”¨v3ç‰ˆæœ¬API
/// let sheets_v3 = &client.sheets.v3;
///
/// // åˆ›å»ºç”µå­è¡¨æ ¼
/// // let create_req = CreateSpreadsheetRequest::builder()
/// //     .title("æ•°æ®ç»Ÿè®¡è¡¨")
/// //     .build();
/// // let response = sheets_v3.spreadsheet.create(create_req, None).await?;
/// ```
pub struct V3 {
    /// ç”µå­è¡¨æ ¼æœåŠ¡ - ç®¡ç†ç”µå­è¡¨æ ¼çš„ç”Ÿå‘½å‘¨æœŸ
    pub spreadsheet: SpreadsheetService,
    /// å·¥ä½œè¡¨æœåŠ¡ - ç®¡ç†å·¥ä½œè¡¨çš„æ“ä½œ
    pub spreadsheet_sheet: SpreadsheetSheetService,
    /// å·¥ä½œè¡¨ç­›é€‰æœåŠ¡ - æä¾›æ•°æ®ç­›é€‰åŠŸèƒ½
    pub spreadsheet_sheet_filter: SpreadsheetSheetFilterService,
    /// å·¥ä½œè¡¨ç­›é€‰è§†å›¾æœåŠ¡ - ç®¡ç†ç­›é€‰è§†å›¾
    pub spreadsheet_sheet_filter_view: SpreadsheetSheetFilterViewService,
    /// æ•°æ®æ“ä½œæœåŠ¡ - å¤„ç†æ•°æ®çš„è¯»å†™å’Œæ“ä½œ
    pub data_operation: DataOperationService,
    /// è¡Œåˆ—æ“ä½œæœåŠ¡ - ç®¡ç†è¡Œåˆ—çš„ç»“æ„
    pub sheet_row_col: SheetRowColService,
}

impl V3 {
    /// åˆ›å»ºæ–°çš„V3ç‰ˆæœ¬æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®ï¼ŒåŒ…å«è®¤è¯ä¿¡æ¯å’ŒAPIè®¾ç½®
    ///
    /// # è¿”å›å€¼
    /// é…ç½®å®Œæˆçš„V3æœåŠ¡å®ä¾‹ï¼ŒåŒ…å«æ‰€æœ‰å­æœåŠ¡æ¨¡å—
    pub fn new(config: Arc<Config>) -> Self {
        Self {
            spreadsheet: SpreadsheetService::new(Arc::clone(&config)),
            spreadsheet_sheet: SpreadsheetSheetService::new(Arc::clone(&config)),
            spreadsheet_sheet_filter: SpreadsheetSheetFilterService::new(Arc::clone(&config)),
            spreadsheet_sheet_filter_view: SpreadsheetSheetFilterViewService::new(Arc::clone(&config)),
            data_operation: DataOperationService::new(Arc::clone(&config)),
            sheet_row_col: SheetRowColService::new(config),
        }
    }
}

/// ç”µå­è¡¨æ ¼æœåŠ¡
///
/// æä¾›ç”µå­è¡¨æ ¼çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬åˆ›å»ºã€è·å–ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚
/// æ”¯æŒè¡¨æ ¼å±æ€§è®¾ç½®ã€æƒé™ç®¡ç†å’Œå…ƒæ•°æ®æ“ä½œã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// - ğŸ“Š åˆ›å»ºæ–°çš„ç”µå­è¡¨æ ¼
/// - ğŸ“‹ è·å–è¡¨æ ¼åŸºæœ¬ä¿¡æ¯å’Œå…ƒæ•°æ®
/// - âœï¸ æ›´æ–°è¡¨æ ¼å±æ€§ï¼ˆæ ‡é¢˜ã€æè¿°ç­‰ï¼‰
/// - ğŸ—‘ï¸ åˆ é™¤ç”µå­è¡¨æ ¼
/// - ğŸ” ç®¡ç†è¡¨æ ¼è®¿é—®æƒé™
/// - ğŸ“ è®¾ç½®è¡¨æ ¼æ‰€å±æ–‡ä»¶å¤¹
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - è‡ªåŠ¨åŒ–æŠ¥è¡¨ç”Ÿæˆ
/// - æ•°æ®å¯¼å…¥å¯¼å‡ºå·¥å…·
/// - æ‰¹é‡è¡¨æ ¼ç®¡ç†
/// - æƒé™æ§åˆ¶ç³»ç»Ÿ
pub struct SpreadsheetService {
    config: Config,
}

impl SpreadsheetService {
    /// åˆ›å»ºæ–°çš„ç”µå­è¡¨æ ¼æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}

/// å·¥ä½œè¡¨æœåŠ¡
///
/// ç®¡ç†ç”µå­è¡¨æ ¼å†…çš„å·¥ä½œè¡¨ï¼ˆSheetï¼‰ï¼Œæ”¯æŒå·¥ä½œè¡¨çš„åˆ›å»ºã€åˆ é™¤ã€é‡å‘½åã€
/// å¤åˆ¶ç­‰æ“ä½œï¼Œä»¥åŠå·¥ä½œè¡¨å±æ€§çš„è®¾ç½®ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// - ğŸ“„ åˆ›å»ºæ–°å·¥ä½œè¡¨
/// - ğŸ“ é‡å‘½åå·¥ä½œè¡¨
/// - ğŸ“‹ å¤åˆ¶å·¥ä½œè¡¨
/// - ğŸ—‘ï¸ åˆ é™¤å·¥ä½œè¡¨
/// - ğŸ¨ è®¾ç½®å·¥ä½œè¡¨å±æ€§ï¼ˆé¢œè‰²ã€ä¿æŠ¤ç­‰ï¼‰
/// - ğŸ“ è°ƒæ•´å·¥ä½œè¡¨å¤§å°
/// - ğŸ”„ ç§»åŠ¨å·¥ä½œè¡¨ä½ç½®
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - å¤šSheetæ•°æ®åˆ†ç±»ç®¡ç†
/// - æ¨¡æ¿å·¥ä½œè¡¨å¤åˆ¶
/// - åŠ¨æ€å·¥ä½œè¡¨ç»“æ„è°ƒæ•´
/// - å·¥ä½œè¡¨æƒé™æ§åˆ¶
pub struct SpreadsheetSheetService {
    config: Config,
}

impl SpreadsheetSheetService {
    /// åˆ›å»ºæ–°çš„å·¥ä½œè¡¨æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}

/// å·¥ä½œè¡¨ç­›é€‰æœåŠ¡
///
/// æä¾›å·¥ä½œè¡¨çš„æ•°æ®ç­›é€‰åŠŸèƒ½ï¼Œæ”¯æŒåˆ›å»ºã€ç®¡ç†å’Œåº”ç”¨ç­›é€‰æ¡ä»¶ã€‚
/// å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®šä½å’ŒæŸ¥çœ‹ç¬¦åˆæ¡ä»¶çš„æ•°æ®ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// - ğŸ” åˆ›å»ºæ•°æ®ç­›é€‰å™¨
/// - âš™ï¸ è®¾ç½®ç­›é€‰æ¡ä»¶
/// - ğŸ”„ æ›´æ–°ç­›é€‰è§„åˆ™
/// - ğŸ—‘ï¸ åˆ é™¤ç­›é€‰å™¨
/// - ğŸ“‹ è·å–ç­›é€‰çŠ¶æ€
/// - ğŸ¯ åº”ç”¨å¤šæ¡ä»¶ç­›é€‰
///
/// # ç­›é€‰ç±»å‹
///
/// - æ•°å€¼ç­›é€‰ï¼ˆå¤§äºã€å°äºã€ç­‰äºç­‰ï¼‰
/// - æ–‡æœ¬ç­›é€‰ï¼ˆåŒ…å«ã€å¼€å§‹äºã€ç»“æŸäºç­‰ï¼‰
/// - æ—¥æœŸç­›é€‰ï¼ˆæ—¥æœŸèŒƒå›´ã€ç›¸å¯¹æ—¥æœŸç­‰ï¼‰
/// - è‡ªå®šä¹‰ç­›é€‰ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ç­‰ï¼‰
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - æ•°æ®åˆ†æå’ŒæŠ¥è¡¨
/// - å¤§é‡æ•°æ®å¿«é€Ÿç­›é€‰
/// - åŠ¨æ€æ•°æ®è§†å›¾
/// - æ¡ä»¶æ•°æ®å¯¼å‡º
pub struct SpreadsheetSheetFilterService {
    config: Config,
}

impl SpreadsheetSheetFilterService {
    /// åˆ›å»ºæ–°çš„å·¥ä½œè¡¨ç­›é€‰æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}

/// å·¥ä½œè¡¨ç­›é€‰è§†å›¾æœåŠ¡
///
/// ç®¡ç†å·¥ä½œè¡¨çš„ç­›é€‰è§†å›¾ï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºã€ä¿å­˜å’Œåˆ‡æ¢ä¸åŒçš„ç­›é€‰é…ç½®ã€‚
/// ç­›é€‰è§†å›¾æ˜¯ä¿å­˜çš„ç­›é€‰å™¨é…ç½®ï¼Œå¯ä»¥å¿«é€Ÿåº”ç”¨å’Œåˆ†äº«ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// - ğŸ‘ï¸ åˆ›å»ºç­›é€‰è§†å›¾
/// - ğŸ’¾ ä¿å­˜ç­›é€‰é…ç½®
/// - ğŸ”„ åˆ‡æ¢ç­›é€‰è§†å›¾
/// - ğŸ“ é‡å‘½åç­›é€‰è§†å›¾
/// - ğŸ—‘ï¸ åˆ é™¤ç­›é€‰è§†å›¾
/// - ğŸ‘¥ åˆ†äº«ç­›é€‰è§†å›¾
/// - ğŸ“‹ è·å–è§†å›¾åˆ—è¡¨
///
/// # è§†å›¾ç‰¹æ€§
///
/// - ä¿å­˜å®Œæ•´çš„ç­›é€‰æ¡ä»¶
/// - åŒ…å«æ’åºè§„åˆ™
/// - æ”¯æŒéšè—åˆ—é…ç½®
/// - å¯è®¾ç½®è§†å›¾æƒé™
/// - æ”¯æŒè§†å›¾åä½œ
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - å›¢é˜Ÿåä½œæ•°æ®åˆ†æ
/// - å¤šç»´åº¦æ•°æ®æŸ¥çœ‹
/// - æ•°æ®è§†å›¾æ¨¡æ¿åŒ–
/// - å¤æ‚ç­›é€‰æ¡ä»¶ä¿å­˜
pub struct SpreadsheetSheetFilterViewService {
    config: Config,
}

impl SpreadsheetSheetFilterViewService {
    /// åˆ›å»ºæ–°çš„å·¥ä½œè¡¨ç­›é€‰è§†å›¾æœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}

/// æ•°æ®æ“ä½œæœåŠ¡
///
/// æä¾›ç”µå­è¡¨æ ¼æ•°æ®çš„æ ¸å¿ƒæ“ä½œåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®è¯»å†™ã€æŸ¥æ‰¾æ›¿æ¢ã€
/// æ ·å¼è®¾ç½®ã€å•å…ƒæ ¼åˆå¹¶ç­‰å…¨é¢çš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// ## æ•°æ®è¯»å†™
/// - ğŸ“– è¯»å–å•ä¸ªæˆ–å¤šä¸ªèŒƒå›´æ•°æ®
/// - âœï¸ å†™å…¥æ•°æ®åˆ°æŒ‡å®šèŒƒå›´
/// - â• åœ¨æœ«å°¾è¿½åŠ æ•°æ®
/// - â¬†ï¸ åœ¨å¼€å¤´æ’å…¥æ•°æ®
///
/// ## æ•°æ®æ“ä½œ
/// - ğŸ” æŸ¥æ‰¾å’Œæ›¿æ¢æ•°æ®
/// - ğŸ”— åˆå¹¶å’Œæ‹†åˆ†å•å…ƒæ ¼
/// - ğŸ¨ è®¾ç½®å•å…ƒæ ¼æ ·å¼
/// - ğŸ–¼ï¸ æ’å…¥å›¾ç‰‡å’Œæµ®åŠ¨å›¾ç‰‡
///
/// ## æ‰¹é‡æ“ä½œ
/// - ğŸ“Š æ‰¹é‡å†™å…¥å¤šä¸ªèŒƒå›´
/// - ğŸ¨ æ‰¹é‡è®¾ç½®æ ·å¼
/// - ğŸ”„ æ‰¹é‡æ•°æ®è½¬æ¢
///
/// # æ”¯æŒçš„æ•°æ®ç±»å‹
///
/// - æ–‡æœ¬å’Œæ•°å­—
/// - æ—¥æœŸå’Œæ—¶é—´
/// - å¸ƒå°”å€¼
/// - å…¬å¼
/// - è¶…é“¾æ¥
/// - å›¾ç‰‡
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - æ•°æ®å¯¼å…¥å¯¼å‡º
/// - æŠ¥è¡¨è‡ªåŠ¨ç”Ÿæˆ
/// - æ•°æ®æ¸…æ´—å’Œå¤„ç†
/// - æ‰¹é‡æ ¼å¼è®¾ç½®
/// - å›¾è¡¨æ•°æ®å‡†å¤‡
pub struct DataOperationService {
    config: Config,
}

impl DataOperationService {
    /// åˆ›å»ºæ–°çš„æ•°æ®æ“ä½œæœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}

/// è¡Œåˆ—æ“ä½œæœåŠ¡
///
/// ç®¡ç†å·¥ä½œè¡¨çš„è¡Œåˆ—ç»“æ„ï¼Œæ”¯æŒæ’å…¥ã€åˆ é™¤ã€è°ƒæ•´è¡Œåˆ—å¤§å°ç­‰æ“ä½œã€‚
/// æä¾›çµæ´»çš„è¡¨æ ¼å¸ƒå±€æ§åˆ¶èƒ½åŠ›ã€‚
///
/// # ä¸»è¦åŠŸèƒ½
///
/// ## è¡Œæ“ä½œ
/// - â• æ’å…¥æ–°è¡Œ
/// - ğŸ—‘ï¸ åˆ é™¤æŒ‡å®šè¡Œ
/// - ğŸ“ è°ƒæ•´è¡Œé«˜
/// - ğŸ‘ï¸ éšè—/æ˜¾ç¤ºè¡Œ
/// - ğŸ”’ å†»ç»“è¡Œ
///
/// ## åˆ—æ“ä½œ
/// - â• æ’å…¥æ–°åˆ—
/// - ğŸ—‘ï¸ åˆ é™¤æŒ‡å®šåˆ—
/// - ğŸ“ è°ƒæ•´åˆ—å®½
/// - ğŸ‘ï¸ éšè—/æ˜¾ç¤ºåˆ—
/// - ğŸ”’ å†»ç»“åˆ—
///
/// ## æ‰¹é‡æ“ä½œ
/// - ğŸ“Š æ‰¹é‡è°ƒæ•´å°ºå¯¸
/// - ğŸ”„ æ‰¹é‡éšè—/æ˜¾ç¤º
/// - â• æ‰¹é‡æ’å…¥
/// - ğŸ—‘ï¸ æ‰¹é‡åˆ é™¤
///
/// # ä½¿ç”¨åœºæ™¯
///
/// - åŠ¨æ€è¡¨æ ¼ç»“æ„è°ƒæ•´
/// - æ•°æ®å±•ç¤ºä¼˜åŒ–
/// - è¡¨æ ¼æ¨¡æ¿åˆ›å»º
/// - å¤§æ•°æ®è¡¨æ ¼ç®¡ç†
/// - ç”¨æˆ·ç•Œé¢å¸ƒå±€æ§åˆ¶
pub struct SheetRowColService {
    #[allow(dead_code)]
    config: Config,
}

impl SheetRowColService {
    /// åˆ›å»ºæ–°çš„è¡Œåˆ—æ“ä½œæœåŠ¡å®ä¾‹
    ///
    /// # å‚æ•°
    /// - `config`: å®¢æˆ·ç«¯é…ç½®
    pub fn new(config: Config) -> Self {
        Self { config }
    }
}
