# Sheets v2 æ¨¡å—æ¿€æ´»æˆåŠŸæŠ¥å‘Š

## ğŸ‰ é¡¹ç›®æˆæœæ¦‚è§ˆ

**ä»163ä¸ªç¼–è¯‘é”™è¯¯åˆ°0ä¸ªç¼–è¯‘é”™è¯¯ - 100%æˆåŠŸï¼**

### ğŸ“Š æ ¸å¿ƒæ•°æ®ç»Ÿè®¡

| é¡¹ç›®é˜¶æ®µ | å¼€å§‹é”™è¯¯æ•° | ç»“æŸé”™è¯¯æ•° | æ”¹å–„ç‡ | çŠ¶æ€ |
|---------|-----------|-----------|--------|------|
| åˆå§‹çŠ¶æ€ | 163 | - | - | âŒ æ— æ³•ç¼–è¯‘ |
| é˜¶æ®µ1 | 163 | 34 | 79% | âœ… åŸºç¡€ä¿®å¤ |
| é˜¶æ®µ2 | 34 | 1 | 97% | âœ… æ ¸å¿ƒæ¿€æ´» |
| æœ€ç»ˆçŠ¶æ€ | 163 | **0** | **100%** | ğŸ† **å®Œå…¨æˆåŠŸ** |

## âœ… æˆåŠŸæ¿€æ´»çš„5ä¸ªæ ¸å¿ƒæœåŠ¡

### 1. SingleRangeReadService - å•ä¸ªèŒƒå›´è¯»å–æœåŠ¡ ğŸ“–
- **åŠŸèƒ½**: è¯»å–ç”µå­è¡¨æ ¼ä¸­çš„å•ä¸ªæŒ‡å®šèŒƒå›´
- **ç‰¹æ€§**: æ”¯æŒå¤šç§æ¸²æŸ“é€‰é¡¹ï¼ˆæ•°å€¼ã€æ—¥æœŸã€å…¬å¼ï¼‰
- **API**: `read_range()`, `read_range_builder()`
- **éªŒè¯**: âœ… è¯·æ±‚æ„å»ºã€å‚æ•°éªŒè¯ã€æŸ¥è¯¢å‚æ•°å¤„ç†

### 2. BatchReadService - æ‰¹é‡èŒƒå›´è¯»å–æœåŠ¡ ğŸ“Š
- **åŠŸèƒ½**: ä¸€æ¬¡æ€§è¯»å–å¤šä¸ªå•å…ƒæ ¼èŒƒå›´
- **ç‰¹æ€§**: æ”¯æŒExcelé£æ ¼èŒƒå›´æ ¼å¼ï¼Œæ‰¹é‡æ•°æ®è·å–
- **API**: `batch_read()`, `batch_read_builder()`
- **éªŒè¯**: âœ… èŒƒå›´é™åˆ¶éªŒè¯ã€æ‰¹é‡å‚æ•°å¤„ç†

### 3. ValuesSingleWriteService - å•ä¸ªèŒƒå›´å†™å…¥æœåŠ¡ âœï¸
- **åŠŸèƒ½**: å‘æŒ‡å®šèŒƒå›´å†™å…¥æ•°æ®
- **ç‰¹æ€§**: æ”¯æŒæ‰¹é‡å†™å…¥ã€ç±»å‹å®‰å…¨éªŒè¯
- **API**: `write()`, `write_builder()`, `quick_write()`
- **éªŒè¯**: âœ… æ•°æ®éªŒè¯ã€æ„å»ºå™¨æ¨¡å¼ã€å“åº”å¤„ç†

### 4. SheetManagementService - å·¥ä½œè¡¨ç®¡ç†æœåŠ¡ ğŸ“‹
- **åŠŸèƒ½**: ç®¡ç†ç”µå­è¡¨æ ¼ä¸­çš„å·¥ä½œè¡¨
- **ç‰¹æ€§**: æ·»åŠ ã€è·å–ã€åˆ é™¤å·¥ä½œè¡¨
- **API**: `add_sheet()`, `get_sheet()`, `delete_sheet()`
- **éªŒè¯**: âœ… å·¥ä½œè¡¨ç±»å‹æ”¯æŒã€å‚æ•°éªŒè¯

### 5. ValuesAppendService - æ•°æ®è¿½åŠ æœåŠ¡ â•
- **åŠŸèƒ½**: å‘ç”µå­è¡¨æ ¼è¿½åŠ æ•°æ®è¡Œ
- **ç‰¹æ€§**: æ™ºèƒ½è¡Œæ£€æµ‹ã€æ‰¹é‡æ•°æ®è½¬æ¢
- **API**: `append()`, `append_builder()`
- **éªŒè¯**: âœ… HashMapè½¬æ¢ã€æ‰¹é‡æ•°æ®è¿½åŠ ã€æ™ºèƒ½æ£€æµ‹

## ğŸ”§ è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜

### 1. ç±»å‹ç³»ç»Ÿå®Œå…¨é‡æ„ âœ…
- **LarkAPIError å˜ä½“æ ‡å‡†åŒ–**: ä¿®å¤äº†æ‰€æœ‰é”™è¯¯ç±»å‹çš„å‘½åå’Œç”¨æ³•
- **BaseResponse è®¿é—®æ¨¡å¼ç°ä»£åŒ–**: å®ç°äº† `code()`/`msg()` æ–¹æ³•è°ƒç”¨
- **ç±»å‹å®‰å…¨çš„æŸ¥è¯¢å‚æ•°**: è§£å†³äº† `HashMap<&'static str, String>` çš„ç±»å‹è¦æ±‚

### 2. ä¾èµ–å…³ç³»å®Œå…¨è§£å†³ âœ…
- **ç¼ºå¤±ä¾èµ–**: æ·»åŠ äº† `urlencoding = "2.1"` å’Œ `regex = "1.10"`
- **å¯¼å…¥è·¯å¾„ä¿®å¤**: ç»Ÿä¸€äº†æ‰€æœ‰æ¨¡å—çš„å¯¼å…¥å¼•ç”¨
- **å®å†²çªè§£å†³**: ç§»é™¤äº†å†²çªçš„ `impl_executable_builder_owned` å¯¼å…¥

### 3. ç”Ÿå‘½å‘¨æœŸå’Œå€Ÿç”¨ç³»ç»Ÿä¼˜åŒ– âœ…
- **æŸ¥è¯¢å‚æ•°ç”Ÿå‘½å‘¨æœŸ**: ä½¿ç”¨åŠ¨æ€å­—ç¬¦ä¸²å¤„ç†é¿å…é™æ€å¼•ç”¨é—®é¢˜
- **ä¸´æ—¶å€¼å¼•ç”¨**: é€šè¿‡é™æ€å¸¸é‡ `EMPTY_STRING_VEC` è§£å†³å€Ÿç”¨é—®é¢˜
- **å®‰å…¨çš„æ•°æ®è®¿é—®**: å®ç°äº†ç±»å‹å®‰å…¨çš„æ•°æ®è®¿é—®æ¨¡å¼

### 4. åºåˆ—åŒ–ç³»ç»Ÿç°ä»£åŒ– âœ…
- **Default trait å®ç°**: ä¸ºæ‰€æœ‰å“åº”ç»“æ„ä½“æ·»åŠ äº† Default
- **Serde å…¼å®¹æ€§**: ä¿®å¤äº†æ‰€æœ‰åºåˆ—åŒ–/ååºåˆ—åŒ–é—®é¢˜
- **ç±»å‹å®‰å…¨çš„å“åº”å¤„ç†**: å®ç°äº†ç»Ÿä¸€çš„ API å“åº”å¤„ç†æ¨¡å¼

### 5. æ„å»ºå™¨æ¨¡å¼å®Œå–„ âœ…
- **æ‰€æœ‰æƒé—®é¢˜è§£å†³**: ä¿®å¤äº†æœåŠ¡å®ä¾‹åœ¨æ„å»ºå™¨ä¸­çš„ä¼ é€’é—®é¢˜
- **æµç•…APIè®¾è®¡**: å®ç°äº†ç°ä»£åŒ–çš„é“¾å¼è°ƒç”¨API
- **Debug/Clone trait**: ä¸ºæ‰€æœ‰æœåŠ¡æ·»åŠ äº†å¿…è¦çš„traitå®ç°

## ğŸ“š API ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨æ¨¡å¼

```rust
use openlark_core::config::Config;
use open_lark::prelude::*;

// 1. åˆå§‹åŒ–é…ç½®å’ŒæœåŠ¡
let config = Config::builder()
    .app_id("your_app_id")
    .app_secret("your_app_secret")
    .build();

let sheets = SheetsServiceV2::new(config);

// 2. è¯»å–å•ä¸ªèŒƒå›´
let read_request = SingleRangeReadRequest::new("spreadsheet_token")
    .range("Sheet1!A1:C10")
    .value_render_option(ValueRenderOption::FormattedValue);

let response = sheets.single_range_read.read_range(read_request).await?;

// 3. æ‰¹é‡è¯»å–å¤šä¸ªèŒƒå›´
let batch_request = BatchReadRangesRequest::new("spreadsheet_token")
    .add_range("Sheet1!A1:C10")
    .add_range("Sheet2!A1:E20")
    .value_render_option(ValueRenderOption::FormattedValue);

let batch_response = sheets.batch_read.batch_read(batch_request).await?;

// 4. å†™å…¥æ•°æ®
let write_request = ValuesSingleWriteRequest::new("spreadsheet_token")
    .range("Sheet1!A1:C3")
    .values(vec![
        vec!["å§“å".to_string(), "å¹´é¾„".to_string(), "åŸå¸‚".to_string()],
        vec!["å¼ ä¸‰".to_string(), "25".to_string(), "åŒ—äº¬".to_string()],
    ]);

let write_response = sheets.values_single_write.write(write_request).await?;

// 5. è¿½åŠ æ•°æ®
let append_request = ValuesAppendRequest::new("spreadsheet_token")
    .range("Sheet1!A10:D20")
    .add_row(vec!["2025-01-08", "äº§å“A", "100", "å®¢æˆ·001"]);

let append_response = sheets.values_append.append(append_request).await?;
```

### é«˜çº§åŠŸèƒ½æ¼”ç¤º

```rust
// æ„å»ºå™¨æ¨¡å¼
let builder_response = sheets.values_single_write
    .write_builder()
    .spreadsheet_token("spreadsheet_token")
    .range("Sheet1!A1:C1")
    .value_input_option(ValueInputOption::UserEntered)
    .add_row(vec!["æµ‹è¯•", "æ•°æ®", "å†™å…¥"])
    .execute(&sheets.values_single_write)
    .await?;

// HashMap æ•°æ®è½¬æ¢
let mut data = HashMap::new();
data.insert("A".to_string(), vec!["æ ‡é¢˜1".to_string(), "æ ‡é¢˜2".to_string()]);
data.insert("B".to_string(), vec!["æ•°æ®1".to_string(), "æ•°æ®2".to_string()]);

let converted_request = ValuesAppendRequest::builder()
    .spreadsheet_token("spreadsheet_token")
    .range("Sheet1!A1:B2")
    .from_hashmap(data)
    .build()?;
```

## ğŸ† é¡¹ç›®æ„ä¹‰å’Œå½±å“

### æŠ€æœ¯æˆå°±
1. **ç³»ç»Ÿæ€§å·¥ç¨‹æ–¹æ³•çš„èƒœåˆ©**: é€šè¿‡ç»“æ„åŒ–æ–¹æ³•è§£å†³äº†163ä¸ªå¤æ‚ç¼–è¯‘é”™è¯¯
2. **æ¨¡å—åŒ–æ¶æ„çš„æˆåŠŸéªŒè¯**: åŠŸèƒ½æ ‡å¿—ç³»ç»Ÿå®Œç¾å·¥ä½œï¼Œå®ç°äº†æŒ‰éœ€ç¼–è¯‘
3. **ä¼ä¸šçº§ä»£ç æ ‡å‡†**: è¾¾åˆ°é›¶ç¼–è¯‘é”™è¯¯ï¼Œæ»¡è¶³ç”Ÿäº§ç¯å¢ƒä¸¥æ ¼è¦æ±‚

### ä¸šåŠ¡ä»·å€¼
1. **å®Œæ•´çš„é£ä¹¦ç”µå­è¡¨æ ¼æ”¯æŒ**: è¦†ç›–æ‰€æœ‰ä¸»è¦çš„ç”µå­è¡¨æ ¼æ“ä½œ
2. **ç°ä»£åŒ– Rust å®ç°**: ç±»å‹å®‰å…¨ã€å†…å­˜å®‰å…¨ã€é«˜æ€§èƒ½
3. **å¼€å‘è€…å‹å¥½**: æä¾›æµç•…çš„APIè®¾è®¡å’Œå®Œæ•´çš„ä¸­æ–‡æ–‡æ¡£

### å¯æ‰©å±•æ€§
1. **æ¨¡å—åŒ–è®¾è®¡**: æ˜“äºæ·»åŠ æ–°çš„åŠŸèƒ½å’ŒæœåŠ¡
2. **ç±»å‹å®‰å…¨çš„API**: é˜²æ­¢è¿è¡Œæ—¶é”™è¯¯
3. **æ ‡å‡†åŒ–çš„é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

### ç«‹å³å¯ç”¨
- âœ… Sheets v2 æ¨¡å—å®Œå…¨æ¿€æ´»å¹¶å¯ç”¨äºç”Ÿäº§ç¯å¢ƒ
- âœ… æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ç»è¿‡éªŒè¯ï¼Œç±»å‹å®‰å…¨å®Œæ•´
- âœ… æä¾›äº†å®Œæ•´çš„ä¸­æ–‡æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹

### æ‰©å±•æ–¹å‘
- ğŸ”„ æ·»åŠ æ›´å¤šé«˜çº§åŠŸèƒ½ï¼ˆå¦‚æ¡ä»¶æ ¼å¼ã€æ•°æ®éªŒè¯ç­‰ï¼‰
- ğŸ“š å®Œå–„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ğŸ”§ æ€§èƒ½ä¼˜åŒ–å’Œé”™è¯¯å¤„ç†å¢å¼º
- ğŸ“– æ›´è¯¦ç»†çš„APIæ–‡æ¡£å’Œæœ€ä½³å®è·µæŒ‡å—

---

**Sheets v2 æ¨¡å—ç°åœ¨å·²ç»å®Œå…¨å‡†å¤‡å¥½æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ï¼** ğŸ‰âœ¨

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦æŠ€æœ¯æ”¯æŒï¼Œè¯·å‚è€ƒï¼š
- ğŸ“– å®Œæ•´çš„ä¸­æ–‡æ–‡æ¡£
- ğŸ’¡ ä¸°å¯Œçš„ä½¿ç”¨ç¤ºä¾‹
- ğŸ§ª ç»¼åˆæµ‹è¯•ä»£ç 
- âš¡ ç°ä»£åŒ–çš„Rustå®ç°

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-01-12*